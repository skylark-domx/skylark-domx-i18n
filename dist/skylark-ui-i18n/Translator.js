/**
 * skylark-ui-i18n - The filer features enhancement for skylark utils.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.1
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx/langx","./i18n"],function(e,r){var a=Object.freeze({amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,"OElig;":338,"oelig;":339,"Scaron;":352,"scaron;":353,"Yuml;":376,"fnof;":402,"circ;":710,"tilde;":732,"Alpha;":913,"Beta;":914,"Gamma;":915,"Delta;":916,"Epsilon;":917,"Zeta;":918,"Eta;":919,"Theta;":920,"Iota;":921,"Kappa;":922,"Lambda;":923,"Mu;":924,"Nu;":925,"Xi;":926,"Omicron;":927,"Pi;":928,"Rho;":929,"Sigma;":931,"Tau;":932,"Upsilon;":933,"Phi;":934,"Chi;":935,"Psi;":936,"Omega;":937,"alpha;":945,"beta;":946,"gamma;":947,"delta;":948,"epsilon;":949,"zeta;":950,"eta;":951,"theta;":952,"iota;":953,"kappa;":954,"lambda;":955,"mu;":956,"nu;":957,"xi;":958,"omicron;":959,"pi;":960,"rho;":961,"sigmaf;":962,"sigma;":963,"tau;":964,"upsilon;":965,"phi;":966,"chi;":967,"psi;":968,"omega;":969,"thetasym;":977,"upsih;":978,"piv;":982,"ensp;":8194,"emsp;":8195,"thinsp;":8201,"zwnj;":8204,"zwj;":8205,"lrm;":8206,"rlm;":8207,"ndash;":8211,"mdash;":8212,"lsquo;":8216,"rsquo;":8217,"sbquo;":8218,"ldquo;":8220,"rdquo;":8221,"bdquo;":8222,"dagger;":8224,"Dagger;":8225,"bull;":8226,"hellip;":8230,"permil;":8240,"prime;":8242,"Prime;":8243,"lsaquo;":8249,"rsaquo;":8250,"oline;":8254,"frasl;":8260,"euro;":8364,"image;":8465,"weierp;":8472,"real;":8476,"trade;":8482,"alefsym;":8501,"larr;":8592,"uarr;":8593,"rarr;":8594,"darr;":8595,"harr;":8596,"crarr;":8629,"lArr;":8656,"uArr;":8657,"rArr;":8658,"dArr;":8659,"hArr;":8660,"forall;":8704,"part;":8706,"exist;":8707,"empty;":8709,"nabla;":8711,"isin;":8712,"notin;":8713,"ni;":8715,"prod;":8719,"sum;":8721,"minus;":8722,"lowast;":8727,"radic;":8730,"prop;":8733,"infin;":8734,"ang;":8736,"and;":8743,"or;":8744,"cap;":8745,"cup;":8746,"int;":8747,"there4;":8756,"sim;":8764,"cong;":8773,"asymp;":8776,"ne;":8800,"equiv;":8801,"le;":8804,"ge;":8805,"sub;":8834,"sup;":8835,"nsub;":8836,"sube;":8838,"supe;":8839,"oplus;":8853,"otimes;":8855,"perp;":8869,"sdot;":8901,"lceil;":8968,"rceil;":8969,"lfloor;":8970,"rfloor;":8971,"lang;":9001,"rang;":9002,"loz;":9674,"spades;":9824,"clubs;":9827,"hearts;":9829,"diams;":9830});function t(r){return e.escapeHTML((t=String(r).replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,""),String(t).replace(/&#(\d+);?/g,function(e,r){return String.fromCharCode(r)}).replace(/&#[xX]([A-Fa-f0-9]+);?/g,function(e,r){return String.fromCharCode(parseInt(r,16))}).replace(/&([^;\W]+;?)/g,function(e,r){var t=r.replace(/;$/,""),n=a[r]||r.match(/;$/)&&a[t];return"number"==typeof n?String.fromCharCode(n):"string"==typeof n?n:e})));var t}var n=function(){console.warn.apply(console,arguments)};Object.assign||jQuery.extend;function i(e){if(!e)throw new TypeError("Parameter `language` must be a language string. Received "+e+(""===e?"(empty string)":""));this.modules=Object.keys(i.moduleFactories).map(function(r){return[r,(0,i.moduleFactories[r])(e)]}).reduce(function(e,r){var a=r[0],t=r[1];return e[a]=t,e},{}),this.lang=e,this.translations={}}return i.prototype.load=function(e,r){return Promise.resolve(jQuery.getJSON(config.relative_path+"/assets/language/"+e+"/"+r+".json?"+config["cache-buster"]))},i.prototype.translate=function(e){var r=new RegExp("[a-zA-Z0-9\\-_.\\/]"),a=new RegExp("[^a-zA-Z0-9\\-_.\\/\\]]"),t=0,n=0,i=e.length,o=[],s=!1;function l(e){for(var r=e.length,a=[],t=0,n=0,i=0;t+2<=r;)"["===e[t]&&"["===e[t+1]?(i+=1,t+=1):"]"===e[t]&&"]"===e[t+1]?(i-=1,t+=1):0===i&&","===e[t]&&"\\"!==e[t-1]&&(a.push(e.slice(n,t).trim()),n=t+=1),t+=1;return a.push(e.slice(n,t+1).trim()),a}for(t=e.indexOf("[[",t);t+2<=i&&-1!==t;){o.push(e.slice(n,t)),n=t+=2,s=!0;for(var u,c,p=0,g=!1,f=!1,m=!1,h=!1;t+2<=i;)if(u=e[t],c=e[t+1],!g&&r.test(u))g=!0,t+=1;else if(g&&!f&&":"===u)f=!0,t+=1;else if(f&&!m&&r.test(u))m=!0,t+=1;else if(m&&!h&&","===u)h=!0,t+=1;else if(g&&f&&m&&h||!a.test(u))if("["===u&&"["===c)p+=1,t+=2;else if("]"===u&&"]"===c){if(0===p){var d=e.slice(n,t),v=l(d),y=v[0],b=v.slice(1),A="";b&&b.length&&(A=this.translate(d)),o.push(this.translateKey(y,b,A)),n=t+=2,s=!1;break}p-=1,t+=2}else t+=1;else{if(t+=1,n-=2,s=!1,!(p>0))break;p-=1}t=e.indexOf("[[",t)}var w=e.slice(n);return s&&(w=this.translate(w)),o.push(w),Promise.all(o).then(function(e){return e.join("")})},i.prototype.translateKey=function(e,r,a){var i=this,o=e.split(":",2),s=o[0],l=o[1];return i.modules[s]?Promise.resolve(i.modules[s](l,r)):s&&!l?(n('Missing key in translation token "'+e+'"'),Promise.resolve("[["+s+"]]")):this.getTranslation(s,l).then(function(o){if(!o)return n('Missing translation "'+e+'"'),a||l;var s=r.map(function(e){return i.translate(t(e))});return Promise.all(s).then(function(e){var r=o;return e.forEach(function(e,a){var t=e.replace(/%(?=\d)/g,"&#37;").replace(/\\,/g,"&#44;");r=r.replace(new RegExp("%"+(a+1),"g"),t)}),r})})},i.prototype.getTranslation=function(e,r){var a;return e?(this.translations[e]=this.translations[e]||this.load(this.lang,e).catch(function(){return{}}),a=this.translations[e]):(n("[translator] Parameter `namespace` is "+e+(""===e?"(empty string)":"")),a=Promise.resolve({})),r?a.then(function(e){return e&&e[r]}):a},i.prototype.translateInPlace=function(e,r){r=r||["placeholder","title"];var a,t=(a=[],function e(r){if(3===r.nodeType)a.push(r);else for(var t=0,n=r.childNodes,i=n.length;t<i;t+=1)e(n[t])}(e),a),n=t.map(function(e){return e.nodeValue}).join("  ||  "),i=r.reduce(function(r,a){var t=Array.prototype.map.call(e.querySelectorAll("["+a+'*="[["]'),function(e){return[a,e]});return r.concat(t)},[]),o=i.map(function(e){return e[1].getAttribute(e[0])}).join("  ||  ");return Promise.all([this.translate(n),this.translate(o)]).then(function(e){var r=e[0],a=e[1];r&&r.split("  ||  ").forEach(function(e,r){$(t[r]).replaceWith(e)}),a&&a.split("  ||  ").forEach(function(e,r){i[r][1].setAttribute(i[r][0],e)})})},i.getLanguage=function(){var e;if("object"==typeof window&&window.config&&window.utils)e=utils.params().lang||config.userLang||config.defaultLang||"en-GB";else{var r=require("../../../src/meta");e=r.config&&r.config.defaultLang?r.config.defaultLang:"en-GB"}return e},i.create=function(e){return e||(e=i.getLanguage()),i.cache[e]=i.cache[e]||new i(e),i.cache[e]},i.cache={},i.registerModule=function(e,r){i.moduleFactories[e]=r,Object.keys(i.cache).forEach(function(a){var t=i.cache[a];t.modules[e]=r(t.lang)})},i.moduleFactories={},i.removePatterns=function(e){for(var r,a=e.length,t=0,n=0,i=0,o="";t<a;)"[["===(r=e.slice(t,t+2))?(0===i&&(o+=e.slice(n,t)),i+=1,t+=2):"]]"===r?(t+=2,0===(i-=1)&&(n=t)):t+=1;return o+=e.slice(n,t)},r.Translator=i});
//# sourceMappingURL=sourcemaps/Translator.js.map
